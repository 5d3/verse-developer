<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Verse Developer Action Sample</title>

    <style>
      pre {
        margin-bottom: 50px;
      }
    </style>

    <script>
      /**
       * Print out Verse API data for all the action samples
       */
      window.addEventListener("message", function(event) {
        var eventData = event.data;

        console.log(event);

        document.getElementById("origin").innerHTML = "Message received. Event origin: "
          + "<hr><pre>" + event.origin + "</pre>";

        /**
         * Message from Verse to check whether your web application is ready.
         */
        if (eventData.verseApiType === "com.ibm.verse.ping.application.loaded") {
          var loaded_message = {
            verseApiType : "com.ibm.verse.application.loaded"
          };
          /**
           * Your application must send a message back to Verse
           * to identify that it's ready to receive data from Verse.
           */
          event.source.postMessage(loaded_message, event.origin);
        }

        /**
         * Print out the Verse API data received in the api-data div.
         */
        if (eventData.verseApiType === "com.ibm.verse.action.clicked") {
          var verseApiData = eventData.verseApiData;
          document.getElementById("api-data").innerHTML = "Verse API Data" + "<hr><pre>"
            + JSON.stringify(verseApiData, null, 2) + "</pre>";

          /**
            * Retrieve data from URL for the Person Sample,
            * and print it in the query-str div.
            */
          if (verseApiData.actionId === "com.ibm.verse.action.sample.person") {
            document.getElementById("query-str").innerHTML = "Query String for Person Action Sample"
            + "<hr><pre>" + window.location.search + "</pre>";
          }
        }
      }, false);
    </script>
  </head>

  <body>
    <h1>Verse Developer Action Sample</h1>
    <div id="origin"></div>
    <div id="query-str"></div>
    <div id="api-data"></div>
  </body>
</html>
