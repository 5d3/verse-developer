<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Verse Developer Action Sample</title>

    <style>
      pre {
        margin-bottom: 50px;
      }
    </style>

    <script>
      /**
       * Print out Verse API data for all the action samples
       */
      window.addEventListener("message", function(event) {
        var eventData = event.data;

        console.log(event);

        document.getElementById("status").innerHTML = "";

        document.getElementById("messages").insertAdjacentHTML('beforeend', "Message received: "
          + "<hr><pre>" + JSON.stringify(eventData, null, 2) + "</pre>");

        /**
         * Message from Verse to check whether your web application is ready.
         */
        if (eventData.verseApiType === "com.ibm.verse.ping.application.loaded") {
          var loaded_message = {
            verseApiType : "com.ibm.verse.application.loaded"
          };
          /**
           * Your application must send a message back to Verse
           * to identify that it's ready to receive data from Verse.
           */
          event.source.postMessage(loaded_message, event.origin);
        }

        /**
          * Retrieve data from URL for the Person Sample,
          * and print it in the query-str div.
          */
        if (eventData.verseApiType === "com.ibm.verse.action.clicked" &&
        eventData.verseApiData.actionId === "com.ibm.verse.action.sample.person") {
          document.getElementById("query-str").innerHTML = "Query String for Person Action Sample"
          + "<hr><pre>" + window.location.search + "</pre>";
        }
      }, false);
    </script>
  </head>

  <body>
    <h1>Verse Developer Action Sample</h1>
    <div id="status">Waiting for messages from Verse.</div>
    <div id="query-str"></div>
    <div id="messages"></div>
  </body>
</html>
