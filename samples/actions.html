<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Verse Developer Action Sample</title>

    <script>
      // Print out context structure for all the Action Samples
      window.addEventListener("message", function(event) {
        console.log("========================message received: %O", event);
        var eventData = event.data;
        //Message from verse to check whether your web application is ready
        if (eventData.verseApiType == "com.ibm.verse.ping.widget.loaded") {
          var loaded_message = {
            verseApiType : "com.ibm.verse.widget.loaded"
          };
          //Your application must send a message back to Verse to identify that
          //it's ready to receive data from Verse
          event.source.postMessage(loaded_message, event.origin);
        }

        if (eventData.verseApiType == "com.ibm.verse.action.clicked") {
          var actionData = eventData.verseApiData;
          var context = actionData.context;
          document.getElementById("context").innerHTML = actionData.actionId + "<hr><pre>"
           + JSON.stringify(context, null, 2) + "</pre><hr>";
        }
      }, false);

      // For retrieving data from URL in the Person Action Sample,
      // and print it in the search_part div.
      window.addEventListener("load", function(event) {
        var eventData = event.data;
        console.log("==========================event", event);
        console.log("========================location.search", window.location.search);
        document.getElementById("search_part").innerHTML = window.location.search;
      }, false);
    </script>
  </head>

  <body>
    <h1>Verse Developer Action Sample</h1>
    <div id="search_part"></div>
    <h2>Context Structure</h2>
    <div id="context"></div>
  </body>
</html>
